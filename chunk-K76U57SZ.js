import{G as A,I as X,M as z,_ as F,a as v,b as k,f as m,h as R,i as _,j as M,l as d,m as h,n as C,o as D,p as I,q as u,s as x,t as y,u as b,v as c,x as w,y as Y}from"./chunk-NWJCKMD5.js";import"./chunk-VJ46IDN7.js";import"./chunk-2FRMAV2F.js";import"./chunk-GX6M6BMO.js";import"./chunk-GEYRJ2HR.js";import"./chunk-563CQL7F.js";import"./chunk-PS2NURIG.js";import"./chunk-FXFZIWDD.js";import"./chunk-CSG5OQLY.js";import"./chunk-VMHM3MLJ.js";import"./chunk-ZD3NZWAU.js";import"./chunk-C5RQ2IC2.js";import"./chunk-42C7ZIID.js";import"./chunk-RW4GY4BD.js";var V=["gameCanvas"],q=["joystickArea"],G=["joystickKnob"];function K(l,i){if(l&1&&(d(0,"div",15)(1,"p"),c(2,"A fatal error has occurred."),h(),d(3,"p"),c(4),h(),d(5,"button",16),c(6,"Return to Menu"),h()()),l&2){let a=u();m(4),Y("Score: ",a.score," Time Survived: ",a.elapsedTime,"s")}}function B(l,i){if(l&1){let a=D();d(0,"div",17)(1,"div",18,1),C(3,"div",19)(4,"div",20,2),h(),d(6,"div",21)(7,"button",22),I("pointerdown",function(){v(a);let n=u();return k(n.attackMelee())}),c(8,"A"),h(),d(9,"button",23),I("pointerdown",function(){v(a);let n=u();return k(n.shoot())}),c(10,"B"),h()()()}}var P=class{constructor(i,a){this.width=40,this.height=60,this.color="red",this.hp=2,this.y=a-this.height,i?(this.x=0-this.width,this.speed=1.5):(this.x=300,this.speed=-1.5),this.image=new Image,this.image.src="assets/demon_warhammer.png"}update(){this.x+=this.speed}draw(i){this.image.complete?i.drawImage(this.image,this.x,this.y,this.width,this.height):(i.fillStyle=this.color,i.fillRect(this.x,this.y,this.width,this.height))}},O=class{constructor(i,a,t){this.radius=5,this.speed=5,this.x=i,this.y=a,this.direction=t}update(){this.x+=this.direction*this.speed}draw(i){i.beginPath(),i.arc(this.x,this.y,this.radius,0,Math.PI*2),i.fillStyle="blue",i.fill()}},E=class{constructor(i,a,t=40,n=60,s="#00ff00"){this.degats_epee=10,this.degats_tir=5,this.pv=3,this.vx=0,this.vy=0,this.speed=3,this.jumpStrength=-12,this.gravity=.6,this.onGround=!1,this.x=i,this.y=a,this.width=t,this.height=n,this.color=s,this.image=new Image,this.image.src="assets/space_marine.png"}update(i,a){this.vy+=this.gravity,this.y+=this.vy,this.x+=this.vx,this.y+this.height>=a?(this.y=a-this.height,this.vy=0,this.onGround=!0):this.onGround=!1,this.x<0&&(this.x=0),this.x+this.width>i&&(this.x=i-this.width)}jump(){this.onGround&&(this.vy=this.jumpStrength,this.onGround=!1)}draw(i,a=!1){if(this.image.complete)if(a){let t=document.createElement("canvas");t.width=this.width*1.3,t.height=this.height*1.3;let n=t.getContext("2d");n&&(n.drawImage(this.image,0,0,t.width,t.height),n.globalCompositeOperation="source-atop",n.fillStyle="rgba(255, 0, 0, 0.5)",n.fillRect(0,0,t.width,t.height),i.drawImage(t,this.x,this.y))}else i.drawImage(this.image,this.x,this.y,this.width*1.3,this.height*1.3);else i.fillStyle=a?"red":this.color,i.fillRect(this.x,this.y,this.width,this.height)}};var Z=(()=>{let i=class i{constructor(){this.dirX=0,this.dirY=0,this.enemies=[],this.projectiles=[],this.lastSpawnTime=0,this.spawnInterval=2e3,this.enemyCount=0,this.startTime=0,this.lastBonusSecond=-1,this.elapsedTime=0,this.score=0,this.isDead=!1,this.invulnerable=!1}attackMelee(){this.enemies.forEach(t=>{Math.abs(this.player.x-t.x)<50&&Math.abs(this.player.y-t.y)<20&&(t.hp-=2,this.score+=2)}),this.enemies=this.enemies.filter(t=>t.hp>0)}shoot(){let t=this.player.vx>=0?1:-1,n=new O(this.player.x+this.player.width/2,this.player.y+this.player.height/2,t);this.projectiles.push(n)}ngOnInit(){}ngAfterViewInit(){this.initCanvas(),this.setupJoystick()}ngOnDestroy(){this.animationId&&cancelAnimationFrame(this.animationId)}initCanvas(){let t=this.canvasRef.nativeElement;this.ctx=t.getContext("2d"),t.width=300,t.height=500,this.player=new E(100,100),this.startTime=Date.now(),this.elapsedTime=0,this.score=0,this.isDead=!1,this.backgroundImg=new Image,this.backgroundImg.src="assets/background.jpg",this.backgroundImg.onload=()=>{this.animate()}}setupJoystick(){let t=this.joystickAreaRef.nativeElement,n=this.joystickKnobRef.nativeElement,s=50,o=20,e={x:s,y:s},r=(p,Q)=>{let j=t.getBoundingClientRect(),g=p-(j.left+e.x),f=Q-(j.top+e.y),S=Math.min(Math.sqrt(g*g+f*f),s-o),T=Math.atan2(f,g);n.style.left=`${e.x+Math.cos(T)*S-o}px`,n.style.top=`${e.y+Math.sin(T)*S-o}px`,this.dirX=g/s,this.dirY=f/s},L=()=>{n.style.left=`${e.x-o}px`,n.style.top=`${e.y-o}px`,this.dirX=0,this.dirY=0};t.addEventListener("pointerdown",p=>{t.setPointerCapture(p.pointerId),r(p.clientX,p.clientY)}),t.addEventListener("pointermove",p=>{p.pressure>0&&r(p.clientX,p.clientY)}),t.addEventListener("pointerup",()=>L())}animate(){let t=this.canvasRef.nativeElement;this.ctx.drawImage(this.backgroundImg,0,0,t.width,t.height);let n=Date.now();this.elapsedTime=Math.floor((n-this.startTime)/1e3),this.elapsedTime>0&&this.elapsedTime%10===0&&Math.floor((n-this.startTime)/1e3)!==this.lastBonusSecond&&(this.score+=5,this.lastBonusSecond=this.elapsedTime),this.player.vx=this.dirX*this.player.speed,this.dirY<-.5&&this.player.onGround&&this.player.jump(),this.player.update(t.width,t.height),this.player.draw(this.ctx,this.invulnerable);let s=Math.max(500,this.spawnInterval-this.elapsedTime*20),o=Date.now();if(o-this.lastSpawnTime>s){let e=Math.random()<.5,r=new P(e,t.height);this.enemyCount++,this.enemyCount%5===0&&(r.speed*=1.5),this.enemies.push(r),this.lastSpawnTime=o}this.projectiles.forEach(e=>e.update()),this.projectiles.forEach(e=>{this.enemies.forEach(r=>{e.x>r.x&&e.x<r.x+r.width&&e.y>r.y&&e.y<r.y+r.height&&(r.hp-=1,this.score+=1,e.x=-9999)})}),!this.isDead&&(this.projectiles=this.projectiles.filter(e=>e.x>0&&e.x<t.width),this.enemies=this.enemies.filter(e=>e.hp>0),this.enemies.forEach(e=>{Math.abs(e.x+e.width/2-(this.player.x+this.player.width/2))<4&&Math.abs(e.y+e.height/2-(this.player.y+this.player.height/2))<4&&(this.invulnerable||(this.player.pv-=1,this.invulnerable=!0,setTimeout(()=>this.invulnerable=!1,1200),this.player.pv<=0&&!this.isDead&&(this.isDead=!0,cancelAnimationFrame(this.animationId))))}),this.enemies.forEach(e=>e.update()),this.enemies.forEach(e=>e.draw(this.ctx)),this.projectiles.forEach(e=>e.draw(this.ctx)),this.animationId=requestAnimationFrame(()=>this.animate()))}};i.\u0275fac=function(n){return new(n||i)},i.\u0275cmp=R({type:i,selectors:[["app-war"]],viewQuery:function(n,s){if(n&1&&(x(V,5),x(q,5),x(G,5)),n&2){let o;y(o=b())&&(s.canvasRef=o.first),y(o=b())&&(s.joystickAreaRef=o.first),y(o=b())&&(s.joystickKnobRef=o.first)}},decls:18,vars:5,consts:[["gameCanvas",""],["joystickArea",""],["joystickKnob",""],[1,"warhammer-background"],[1,"header-bar"],["routerLink","/home",1,"back-button"],[1,"game-title"],[1,"game-container"],[1,"game-canvas"],[1,"hud"],[1,"score"],[1,"timer"],[1,"life"],["class","death-screen",4,"ngIf"],["class","controls",4,"ngIf"],[1,"death-screen"],["routerLink","/home"],[1,"controls"],[1,"joystick-container"],[1,"joystick-base"],[1,"joystick-knob"],[1,"buttons"],[1,"btn-a",3,"pointerdown"],[1,"btn-b",3,"pointerdown"]],template:function(n,s){n&1&&(d(0,"main",3)(1,"div",4)(2,"button",5),c(3,"\u21A9\uFE0F Menu"),h(),d(4,"h1",6),c(5,"Warhammer"),h()(),d(6,"div",7),C(7,"canvas",8,0),d(9,"div",9)(10,"div",10),c(11),h(),d(12,"div",11),c(13),h(),d(14,"div",12),c(15),h()(),_(16,K,7,2,"div",13),h(),_(17,B,11,0,"div",14),h()),n&2&&(m(11),w("Score: ",s.score,""),m(2),w("Time: ",s.elapsedTime,"s"),m(2),w("\u2764\uFE0F ",s.player==null?null:s.player.pv,""),m(),M("ngIf",s.isDead),m(),M("ngIf",!s.isDead))},dependencies:[X,A,F,z],styles:[".warhammer-background[_ngcontent-%COMP%]{min-height:100vh;background:#1a1a1a;display:flex;flex-direction:column;align-items:center;padding:20px}.game-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:20px;margin-top:60px}.game-title[_ngcontent-%COMP%]{color:gold;font-size:3rem;font-weight:700;text-shadow:2px 2px 4px rgba(0,0,0,.5);margin:0}.game-canvas[_ngcontent-%COMP%]{width:300px!important;height:500px!important;border:2px solid black;display:block;margin:0 auto}.controls[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-top:10px}.joystick-container[_ngcontent-%COMP%]{position:relative;width:100px;height:100px;margin-left:20px;touch-action:none}.joystick-base[_ngcontent-%COMP%]{position:absolute;width:100px;height:100px;border-radius:50%;background:#80808080}.joystick-knob[_ngcontent-%COMP%]{position:absolute;left:40px;top:40px;width:40px;height:40px;border-radius:50%;background:#fff}.buttons[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-right:20px;gap:15px}button.btn-a[_ngcontent-%COMP%], button.btn-b[_ngcontent-%COMP%]{width:60px;height:60px;border-radius:50%;font-size:20px;font-weight:700;border:none;color:#fff}.btn-a[_ngcontent-%COMP%]{background:#e74c3c}.btn-b[_ngcontent-%COMP%]{background:#3498db}.back-button[_ngcontent-%COMP%]{position:fixed;top:20px;left:20px;background:gold;border:none;padding:12px 20px;border-radius:25px;color:#1a1a1a;font-size:1rem;font-weight:700;cursor:pointer;transition:all .2s ease;z-index:1000}.back-button[_ngcontent-%COMP%]:hover{background:#ffeb3b;transform:translateY(-2px);box-shadow:0 5px 15px #ffd70066}@media (max-width: 768px){.game-title[_ngcontent-%COMP%]{font-size:2rem}.game-canvas[_ngcontent-%COMP%]{width:90vw;height:60vh}}.header-bar[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:8px}.hud[_ngcontent-%COMP%]{position:absolute;top:10px;right:10px;color:#fff;font-size:16px;font-weight:700;text-align:right}.death-screen[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#00a;color:#fff;font-family:Courier New,monospace;display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center;padding:20px;z-index:9999}.death-screen[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:28px;margin-bottom:20px}.death-screen[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:18px;margin:8px 0}.death-screen[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-top:30px;padding:12px 24px;font-size:16px;font-weight:700;font-family:inherit;border:2px solid white;border-radius:4px;background:transparent;color:#fff;cursor:pointer}.death-screen[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background:#fff;color:#00a}"]});let l=i;return l})();export{Z as WarComponent};
