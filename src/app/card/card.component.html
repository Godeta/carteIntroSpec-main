<header *ngIf="!showPlayerSetup">
  <h1>Pasapa</h1>
  <button class="shiny-button" routerLink="/home">Back</button>
  <div class="right">
  <button class="icon-button" (click)="toggleRules()">‚ùì</button>
  <button class="icon-button" (click)="toggleActionCard()">‚ö° Action</button>
    </div>
</header>

<main>
  <!-- Player Setup Screen -->
  <div *ngIf="showPlayerSetup" class="player-setup">
    <header class="game-header">
      <h1 class="game-title title-setup">Pasapa</h1>
    <button class="back-button-setup" routerLink="/home">Retour au menu</button>
    </header>
    <h2>Configuration des joueurs</h2>
    <div class="player-inputs">
      <div *ngFor="let player of players; let i = index; trackBy: trackByIndex" class="player-input">
        <input
          [(ngModel)]="players[i]"
          [id]="'player-' + i"
          placeholder="Nom du joueur {{ i + 1 }}"
          (input)="updatePlayer(i, $event)">
        <button (click)="removePlayer(i)" *ngIf="players.length > 2">√ó</button>
      </div>
    </div>
    <button (click)="addPlayer()" class="add-player" [disabled]="players.length >= 11">Ajouter un joueur</button>
    <div class="voltage-button" [class.disabled]="!canStartGame()">
      <button (click)="startGameMode()" [disabled]="!canStartGame()">Commencer le jeu</button>
      <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 234.6 61.3" preserveAspectRatio="none" xml:space="preserve">
        <filter id="glow">
          <fegaussianblur class="blur" result="coloredBlur" stddeviation="2"></fegaussianblur>
          <feTurbulence type="fractalNoise" baseFrequency="0.075" numOctaves="0.3" result="turbulence"></feTurbulence>
          <feDisplacementMap in="SourceGraphic" in2="turbulence" scale="30" xChannelSelector="R" yChannelSelector="G" result="displace"></feDisplacementMap>
          <femerge>
            <femergenode in="coloredBlur"></femergenode>
            <femergenode in="coloredBlur"></femergenode>
            <femergenode in="coloredBlur"></femergenode>
            <femergenode in="displace"></femergenode>
            <femergenode in="SourceGraphic"></femergenode>
          </femerge>
        </filter>
        <path class="voltage line-1" d="m216.3 51.2c-3.7 0-3.7-1.1-7.3-1.1-3.7 0-3.7 6.8-7.3 6.8-3.7 0-3.7-4.6-7.3-4.6-3.7 0-3.7 3.6-7.3 3.6-3.7 0-3.7-0.9-7.3-0.9-3.7 0-3.7-2.7-7.3-2.7-3.7 0-3.7 7.8-7.3 7.8-3.7 0-3.7-4.9-7.3-4.9-3.7 0-3.7-7.8-7.3-7.8-3.7 0-3.7-1.1-7.3-1.1-3.7 0-3.7 3.1-7.3 3.1-3.7 0-3.7 10.9-7.3 10.9-3.7 0-3.7-12.5-7.3-12.5-3.7 0-3.7 4.6-7.3 4.6-3.7 0-3.7 4.5-7.3 4.5-3.7 0-3.7 3.6-7.3 3.6-3.7 0-3.7-10-7.3-10-3.7 0-3.7-0.4-7.3-0.4-3.7 0-3.7 2.3-7.3 2.3-3.7 0-3.7 7.1-7.3 7.1-3.7 0-3.7-11.2-7.3-11.2-3.7 0-3.7 3.5-7.3 3.5-3.7 0-3.7 3.6-7.3 3.6-3.7 0-3.7-2.9-7.3-2.9-3.7 0-3.7 8.4-7.3 8.4-3.7 0-3.7-14.6-7.3-14.6-3.7 0-3.7 5.8-7.3 5.8-2.2 0-3.8-0.4-5.5-1.5-1.8-1.1-1.8-2.9-2.9-4.8-1-1.8 1.9-2.7 1.9-4.8 0-3.4-2.1-3.4-2.1-6.8s-9.9-3.4-9.9-6.8 8-3.4 8-6.8c0-2.2 2.1-2.4 3.1-4.2 1.1-1.8 0.2-3.9 2-5 1.8-1 3.1-7.9 5.3-7.9 3.7 0 3.7 0.9 7.3 0.9 3.7 0 3.7 6.7 7.3 6.7 3.7 0 3.7-1.8 7.3-1.8 3.7 0 3.7-0.6 7.3-0.6 3.7 0 3.7-7.8 7.3-7.8h7.3c3.7 0 3.7 4.7 7.3 4.7 3.7 0 3.7-1.1 7.3-1.1 3.7 0 3.7 11.6 7.3 11.6 3.7 0 3.7-2.6 7.3-2.6 3.7 0-3.7-12.9 7.3-12.9 3.7 0 3.7 10.9 7.3 10.9 3.7 0 3.7 1.3 7.3 1.3 3.7 0 3.7-8.7 7.3-8.7 3.7 0 3.7 11.5 7.3 11.5 3.7 0 3.7-1.4 7.3-1.4 3.7 0 3.7-2.6 7.3-2.6 3.7 0 3.7-5.8 7.3-5.8 3.7 0 3.7-1.3 7.3-1.3 3.7 0 3.7 6.6 7.3 6.6s3.7-9.3 7.3-9.3c3.7 0 3.7 0.2 7.3 0.2 3.7 0 3.7 8.5 7.3 8.5 3.7 0 3.7 0.2 7.3 0.2 3.7 0 3.7-1.5 7.3-1.5 3.7 0 3.7 1.6 7.3 1.6s3.7-5.1 7.3-5.1c2.2 0 0.6 9.6 2.4 10.7s4.1-2 5.1-0.1c1 1.8 10.3 2.2 10.3 4.3 0 3.4-10.7 3.4-10.7 6.8s1.2 3.4 1.2 6.8 1.9 3.4 1.9 6.8c0 2.2 7.2 7.7 6.2 9.5-1.1 1.8-12.3-6.5-14.1-5.5-1.7 0.9-0.1 6.2-2.2 6.2z" fill="transparent" stroke="#fff"/>
        <path class="voltage line-2" d="m216.3 52.1c-3 0-3-0.5-6-0.5s-3 3-6 3-3-2-6-2-3 1.6-6 1.6-3-0.4-6-0.4-3-1.2-6-1.2-3 3.4-6 3.4-3-2.2-6-2.2-3-3.4-6-3.4-3-0.5-6-0.5-3 1.4-6 1.4-3 4.8-6 4.8-3-5.5-6-5.5-3 2-6 2-3 2-6 2-3 1.6-6 1.6-3-4.4-6-4.4-3-0.2-6-0.2-3 1-6 1-3 3.1-6 3.1-3-4.9-6-4.9-3 1.5-6 1.5-3 1.6-6 1.6-3-1.3-6-1.3-3 3.7-6 3.7-3-6.4-6-6.4-3 2.5-6 2.5h-6c-3 0-3-0.6-6-0.6s-3-1.4-6-1.4-3 0.9-6 0.9-3 4.3-6 4.3-3-3.5-6-3.5c-2.2 0-3.4-1.3-5.2-2.3-1.8-1.1-3.6-1.5-4.6-3.3s-4.4-3.5-4.4-5.7c0-3.4 0.4-3.4 0.4-6.8s2.9-3.4 2.9-6.8-0.8-3.4-0.8-6.8c0-2.2 0.3-4.2 1.3-5.9 1.1-1.8 0.8-6.2 2.6-7.3 1.8-1 5.5-2 7.7-2 3 0 3 2 6 2s3-0.5 6-0.5 3 5.1 6 5.1 3-1.1 6-1.1 3-5.6 6-5.6 3 4.8 6 4.8 3 0.6 6 0.6 3-3.8 6-3.8 3 5.1 6 5.1 3-0.6 6-0.6 3-1.2 6-1.2 3-2.6 6-2.6 3-0.6 6-0.6 3 2.9 6 2.9 3-4.1 6-4.1 3 0.1 6 0.1 3 3.7 6 3.7 3 0.1 6 0.1 3-0.6 6-0.6 3 0.7 6 0.7 3-2.2 6-2.2 3 4.4 6 4.4 3-1.7 6-1.7 3-4 6-4 3 4.7 6 4.7 3-0.5 6-0.5 3-0.8 6-0.8 3-3.8 6-3.8 3 6.3 6 6.3 3-4.8 6-4.8 3 1.9 6 1.9 3-1.9 6-1.9 3 1.3 6 1.3c2.2 0 5-0.5 6.7 0.5 1.8 1.1 2.4 4 3.5 5.8 1 1.8 0.3 3.7 0.3 5.9 0 3.4 3.4 3.4 3.4 6.8s-3.3 3.4-3.3 6.8 4 3.4 4 6.8c0 2.2-6 2.7-7 4.4-1.1 1.8 1.1 6.7-0.7 7.7-1.6 0.8-4.7-1.1-6.8-1.1z" fill="transparent" stroke="#fff"/>
      </svg>
      <div class="dots">
        <div class="dot dot-1"></div>
        <div class="dot dot-2"></div>
        <div class="dot dot-3"></div>
        <div class="dot dot-4"></div>
        <div class="dot dot-5"></div>
      </div>
    </div>
  </div>

  <!-- Next Turn Screen -->
  <div *ngIf="showNextTurn" class="next-turn">
    <h2>Tour suivant !</h2>
    <p>Cat√©gorie suivante: {{ gameCategories[currentCategoryIndex + 1] }}</p>
    <button (click)="nextTurn()" class="continue-btn">Continuer</button>
  </div>

  <!-- Game End Screen -->
  <div *ngIf="showGameEnd" class="game-end">
    <h2>Fin de partie</h2>
    <p>F√©licitations ! Vous avez termin√© toutes les cat√©gories.</p>
    <button routerLink="/home" class="home-btn">Retour au menu</button>
  </div>

  <!-- Game Screen -->
  <div *ngIf="gameStarted && !showNextTurn && !showGameEnd" class="game-screen">
    <header class="game-header">
      <h1 class="game-title">Pasapa</h1>
    </header>

    <div class="libre-controls" *ngIf="gameMode === 'libre'">
      <div class="left-buttons">
        <button class="control-button" routerLink="/home">Menu</button>
        <button class="control-button" (click)="resetLibreMode()">Reset</button>
      </div>

      <div class="center-selector">
        <span class="cards-played">Cartes jou√©es: {{ cardsPlayed }}</span>
        <label for="category">Cat√©gorie: </label>
        <select id="category" (change)="onCategoryChange($event)">
          <option value="all">Toutes</option>
          <option *ngFor="let category of uniqueCategories" [value]="category">{{ category }}</option>
        </select>
      </div>

      <div class="right-icons">
        <button class="icon-button" (click)="toggleRules()">‚ùì</button>
        <button class="icon-button" (click)="toggleActionCard()">‚ö°</button>
      </div>
    </div>

    <div class="game-controls" *ngIf="gameMode === 'jeu'">
      <div class="left-buttons">
        <button class="control-button" routerLink="/home">Menu</button>
        <button class="control-button" (click)="restartGame()">Restart</button>
      </div>

      <div class="center-info">
        <p><strong>Tour </strong> <span class="info-value">{{ currentTurn }}</span> - <strong>Cat√©gorie: </strong> <span class="info-value category-color">{{ currentCategory }}</span></p>
        <p><strong>Joueur actuel: </strong> <span class="player-name">{{ currentPlayer }}</span></p>
        <p>Cartes jou√©es ce tour: {{ cardsPlayedThisTurn }}/{{ totalCardsPerTurn }}</p>
      </div>

      <div class="right-actions">
        <p>Action du tour : <span class="classique">classique</span> ou <span class="action-title">{{ currentActionCard.title }}</span></p>
        <div class="action-icons">
          <button class="icon-button" (click)="toggleRules()">‚ùì</button>
          <button class="icon-button" (click)="toggleActionCard()">‚ö°</button>
        </div>
      </div>
    </div>

    <div class="card-container">
      <div #cardElement class="card" [ngStyle]="{'background-color': currentCardColor}">
        <img class="card-background-image" [src]="'assets/cards/' + currentCard.name + '.jpg'" [alt]="currentCard.name">
        <div class="category-badge">{{ currentCard.category }}</div>
        <div class="card-content">
          <h2>{{ currentCard.question }}</h2>
        </div>
        <!-- <button class="scroll-button" (click)="scrollToInfo()">üëÅÔ∏è</button> -->
      </div>
    </div>
    <button class="shiny-button next-button" (click)="nextCard()">
      <span>Question suivante</span>
    </button>
    <div class="info-area">
      <h3>Cartes jou√©es</h3>
      <div class="played-cards">
        <img *ngFor="let cardName of playedCardNames"
             class="card-image"
             [src]="'assets/cards/' + cardName + '.jpg'"
             [alt]="cardName">
        <p *ngIf="playedCardNames.length === 0">Aucune carte jou√©e pour le moment</p>
      </div>
    </div>
  </div>

<!-- R√®gles du jeu -->
<div class="popup" *ngIf="showRules">
  <div class="popup-content">
    <button class="close-button" (click)="toggleRules()">‚úñ</button>
    <h2>R√®gles du jeu</h2>
    <p>
      Le jeu se d√©roule en plusieurs <strong>cat√©gories de questions</strong> (7 au total), en commen√ßant toujours par la cat√©gorie <em>L√©ger</em>.
    </p>
    <ul>
      <li>Un <strong>tour de jeu</strong> se termine lorsque tous les joueurs ont r√©pondu √† une carte de la cat√©gorie en cours.</li>
      <li>√Ä la fin d‚Äôun tour, le groupe choisit de <em>rejouer dans la m√™me cat√©gorie</em> ou de <em>passer √† la suivante</em>.</li>
      <li>√Ä chaque tour, on tire √©galement une <strong>carte Action</strong> au hasard, ce qui nous laisse le choix au moment de jouer de suivre :
        <ul>
          <li>soit la carte ‚Äúclassique‚Äù ‚Üí r√©pondre √† la question,</li>
          <li>soit une <em>carte sp√©ciale</em> ‚Üí  il faut r√©aliser une action / r√©pondre d'un certaine fa√ßon</li>
        </ul>
      </li>
      <li>Il est conseill√© de terminer la partie par une carte de la cat√©gorie <em>Ensemble</em>, m√™me si vous arr√™tez avant d‚Äôavoir jou√© toutes les cat√©gories.</li>
    </ul>
    <p>
      Le but est d' <strong>√©changer et discuter</strong>.
      Donc laissez-vous aller : digressez, sortez du sujet, parlez de tout et de rien !
    </p>
  </div>
</div>


<!-- Action Card Popup -->
<div class="popup" *ngIf="showActionCard">
  <div class="popup-content action-card">
    <button class="close-button" (click)="toggleActionCard()">‚úñ</button>
    <div class="action-card-sections">
      <div class="classic">
        <h3>Jeu classique</h3>
        <p>Tu r√©ponds √† la question, les autres s‚Äôexpriment / tu peux leur poser la question</p>
      </div>
      <div class="random">
        <h3>{{ currentActionCard.title }}</h3>
        <p>{{ currentActionCard.description }}</p>
        <button class="shiny-button" (click)="getRandomActionCard()">New Random Card</button>
      </div>
    </div>
  </div>
</div>


</main>


